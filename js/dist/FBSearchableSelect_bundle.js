var RedNaoFBSearchableSelect=function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1510)}({0:function(e,t){e.exports=React},100:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Fields/Core/FBMultipleOptionsBase.Model")},117:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Fields/Core/FBMultipleOptionsBase.Options")},1510:function(e,t,i){"use strict";i.r(t),i.d(t,"FBSearchableSelect",(function(){return X}));var n,s,o,r,l=i(0),a=i(6),c=i(3),d=i(66),u=i(9),p=i(117);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t,i){return t&&v(e.prototype,t),i&&v(e,i),e}function y(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?b(e):t}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t,i){return(O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(i):s.value}})(e,t,i||e)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I,F,C,x,A,k,P=function(e){function t(){var e,i;g(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(i=y(this,(e=w(t)).call.apply(e,[this].concat(s)))).ImageType=void 0,i.Ref=void 0,i}return _(t,e),m(t,[{key:"LoadDefaultValues",value:function(){O(w(t.prototype),"LoadDefaultValues",this).call(this),this.ImageType="none",this.Ref=""}}]),t}(d.OptionItem),E=(n=Object(u.StoreDataType)(P),r=function(e){function t(){var e,i;g(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(i=y(this,(e=w(t)).call.apply(e,[this].concat(s)))).Placeholder=void 0,i.ShowOptionsPrice=void 0,i.Prefix=void 0,i.SkipWhenPriceIsZero=void 0,i.AllowMultiple=void 0,f(i,"Options",o,b(i)),i}return _(t,e),m(t,[{key:"LoadDefaultValues",value:function(){O(w(t.prototype),"LoadDefaultValues",this).call(this),this.Type=c.FieldTypeEnum.SearchableDropdown,this.Label="Dropdown",this.Placeholder="Please select a value",this.PriceType=a.PriceTypeEnum.options,this.AllowMultiple=!1,this.ShowOptionsPrice=!1,this.Prefix=" +",this.SkipWhenPriceIsZero=!0}}]),t}(p.FBMultipleOptionsBaseOptions),I=(s=r).prototype,F="Options",C=[n],x={configurable:!0,enumerable:!0,writable:!0,initializer:null},k={},Object.keys(x).forEach((function(e){k[e]=x[e]})),k.enumerable=!!k.enumerable,k.configurable=!!k.configurable,("value"in k||k.initializer)&&(k.writable=!0),k=C.slice().reverse().reduce((function(e,t){return t(I,F,e)||e}),k),A&&void 0!==k.initializer&&(k.value=k.initializer?k.initializer.call(A):void 0,k.initializer=void 0),void 0===k.initializer&&(Object.defineProperty(I,F,k),k=null),o=k,s),L=i(40);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(e,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=j(this,R(t).call(this,e,i))).SelectedValues=void 0,n.IsFocused=void 0,n}var i,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,e),i=t,(n=[{key:"GetDynamicFieldNames",value:function(){return["FBSearchableSelect"]}},{key:"AllowMultiple",get:function(){return!1}}])&&T(i.prototype,n),s&&T(i,s),t}(i(100).FBMultipleOptionsBaseModel),N=i(29),V=i(27),q=i(28),$=i(2),z=i(95),G=i(32),H=i(276),Q=i.n(H);i(667);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var X=function(e){function t(e){var i,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(i=!(s=W(t).call(this,e))||"object"!==K(s)&&"function"!=typeof s?Z(n):s).TomSelect=void 0,i.Formatter=void 0,i.Formatter=document.createElement("div"),i.DropDownRendered=i.DropDownRendered.bind(Z(i)),i}var i,n,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,e),i=t,(n=[{key:"DropDownRendered",value:function(e){var t=this;if(null!=e){null!=this.TomSelect&&this.TomSelect.destroy();var i=function(e){var i=t.Model.Options.Options.find((function(t){return t.Id==e.optionId})),n=document.createElement("div");n.classList.add("searchableOption");var s=document.createElement("div");switch(s.classList.add("optionImage"),i.ImageType){case"icon":var o=t.Model.RootFormBuilder.GetIcon(i.Ref.Name),r=o.icon[0],l=o.icon[1],a="0 0 ".concat(r," ").concat(l),c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("viewBox",a),c.style.height="1em",c.setAttribute("fill","currentColor");var d=document.createElementNS("http://www.w3.org/2000/svg","path");c.appendChild(d),d.setAttribute("d",o.icon[4]),s.appendChild(c),n.appendChild(s);break;case"image":var u=document.createElement("div");u.classList.add("imageContainer"),u.style.backgroundImage="url('"+i.Ref.URL+"')",s.appendChild(u),n.appendChild(s)}var p=document.createElement("span");return p.innerText=e.text,n.appendChild(p),n},n={onChange:function(e){Array.isArray(e)?t.Model.SetSelection(e.map((function(e){return Number(e)}))):t.Model.SetSelection([e])},items:this.Model.SelectedValues,plugins:{},render:{option:function(e,t){return i(e)},item:function(e,t){return i(e)}}};this.Model.Options.AllowMultiple&&(n.plugins.remove_button={className:"rnOptionRemove"}),this.TomSelect=new Q.a(e,n)}}},{key:"componentWillReceiveProps",value:function(e,t){if(this.Model.Parent.IsDesign){var i=this.props.Model.Options.Options.find((function(e){return e.Selected}));this.Model.SelectedValues=i?[i.Id]:[],this.Model.SetQuantity(this.Model.Options.QuantityDefaultValue),this.Model.Refresh()}}},{key:"SubRender",value:function(){return this.Model.Options.ShowQuantitySelector&&this.Model.Options.PriceType!=a.PriceTypeEnum.quantity?"bottom"==this.Model.Options.QuantityPosition||"right"==this.Model.Options.QuantityPosition?l.createElement(l.Fragment,null,this.GetInput(this.Model.Options.QuantityPosition),this.GetQuantityInput(),this.GetPriceOrRequiredBox()):l.createElement(l.Fragment,null,this.GetQuantityInput(),this.GetInput(this.Model.Options.QuantityPosition),this.GetPriceOrRequiredBox()):l.createElement(l.Fragment,null,this.GetInput(""),this.GetPriceOrRequiredBox())}},{key:"GetInput",value:function(e){var t=this;return l.createElement("div",{className:"rnTextFieldInput "+e+(this.Model.IsFocused?" RNFocus":"")},this.GetLabel(),l.createElement("select",{multiple:this.Model.Options.AllowMultiple,ref:this.DropDownRendered,onFocus:function(){t.Model.IsFocused=!0,t.Model.Refresh()},onBlur:function(){t.Model.IsFocused=!1,t.Model.Refresh()},className:"rnInputPrice",placeholder:this.Model.Options.Placeholder,style:{width:"100%"},value:0==this.Model.SelectedValues.length?"":this.Model.SelectedValues[0],onChange:function(e){return t.OnChange(e)}},l.createElement("option",{key:-1,value:""},this.Model.Options.Placeholder),this.Model.Options.Options.map((function(e){return l.createElement("option",{"data-option-id":e.Id,disabled:t.Model.IsOptionDisabled(e.Id),key:e.Id,value:e.Id},t.GetOptionLabel(e))}))))}},{key:"OnChange",value:function(e){this.Model.ToggleSelection(e.target.value,!0)}},{key:"GetOptionLabel",value:function(e){var t=e.Label;return this.props.Model.Options.ShowOptionsPrice&&(!this.props.Model.Options.SkipWhenPriceIsZero||G.Sanitizer.SanitizeNumber(e.RegularPrice)>0)&&(t+=this.props.Model.Options.Prefix+z.CurrencyManager.FormatPrice(e.RegularPrice),this.Formatter.innerHTML=t,t=this.Formatter.innerText),t}}])&&U(i.prototype,n),s&&U(i,s),t}(L.FBFieldWithPriceBase);X.defaultProps={},$.EventManager.Subscribe(N.GetModel,(function(e){if(e.Options.Type==c.FieldTypeEnum.SearchableDropdown)return new D(e.Options,e.parent).Initialize(e.PreviousData)})),$.EventManager.Subscribe(V.GetFieldOptions,(function(e){if(e.Type==c.FieldTypeEnum.SearchableDropdown)return new E})),$.EventManager.Subscribe(q.GetField,(function(e){if(e.Model.Options.Type==c.FieldTypeEnum.SearchableDropdown)return l.createElement(X,{Model:e.Model})}))},2:function(e,t){e.exports=RedNaoSharedCore.default("shared/core/Events/EventManager")},27:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Events/GetFieldOptions")},276:function(e,t,i){e.exports=function(){"use strict";function e(e,t){e.split(/\s+/).forEach(e=>{t(e)})}class t{constructor(){this._events=void 0,this._events={}}on(t,i){e(t,e=>{this._events[e]=this._events[e]||[],this._events[e].push(i)})}off(t,i){var n=arguments.length;0!==n?e(t,e=>{if(1===n)return delete this._events[e];e in this._events!=0&&this._events[e].splice(this._events[e].indexOf(i),1)}):this._events={}}trigger(t,...i){var n=this;e(t,e=>{if(e in n._events!=0)for(let t of n._events[e])t.apply(n,i)})}}var i;const n=new RegExp("[̀-ͯ·ʾ]","g");var s;const o={"æ":"ae","ⱥ":"a","ø":"o"},r=new RegExp(Object.keys(o).join("|"),"g"),l=[[67,67],[160,160],[192,438],[452,652],[961,961],[1019,1019],[1083,1083],[1281,1289],[1984,1984],[5095,5095],[7429,7441],[7545,7549],[7680,7935],[8580,8580],[9398,9449],[11360,11391],[42792,42793],[42802,42851],[42873,42897],[42912,42922],[64256,64260],[65313,65338],[65345,65370]],a=e=>e.normalize("NFKD").replace(n,"").toLowerCase().replace(r,(function(e){return o[e]})),c=(e,t="|")=>{if(1==e.length)return e[0];var i=1;return e.forEach(e=>{i=Math.max(i,e.length)}),1==i?"["+e.join("")+"]":"(?:"+e.join(t)+")"},d=e=>{if(1===e.length)return[[e]];var t=[];return d(e.substring(1)).forEach((function(i){var n=i.slice(0);n[0]=e.charAt(0)+n[0],t.push(n),(n=i.slice(0)).unshift(e.charAt(0)),t.push(n)})),t},u=e=>(void 0===s&&(s=(()=>{var e={};l.forEach(t=>{for(let n=t[0];n<=t[1];n++){let t=String.fromCharCode(n),s=a(t);if(s!=t.toLowerCase()){s in e||(e[s]=[s]);var i=new RegExp(c(e[s]),"iu");t.match(i)||e[s].push(t)}}});var t=Object.keys(e);t=t.sort((e,t)=>t.length-e.length),i=new RegExp("("+c(t)+"[̀-ͯ·ʾ]*)","g");var n={};return t.sort((e,t)=>e.length-t.length).forEach(t=>{var i=d(t).map(t=>(t=t.map(t=>e.hasOwnProperty(t)?c(e[t]):t),c(t,"")));n[t]=c(i)}),n})()),e.normalize("NFKD").toLowerCase().split(i).map(e=>{if(""==e)return"";const t=a(e);if(s.hasOwnProperty(t))return s[t];const i=e.normalize("NFC");return i!=e?c([e,i]):e}).join("")),p=(e,t)=>{if(e)return e[t]},h=(e,t)=>{if(e){for(var i,n=t.split(".");(i=n.shift())&&(e=e[i]););return e}},f=(e,t,i)=>{var n,s;return e?-1===(s=(e+="").search(t.regex))?0:(n=t.string.length/e.length,0===s&&(n+=.5),n*i):0},g=e=>(e+"").replace(/([\$\(-\+\.\?\[-\^\{-\}])/g,"\\$1"),v=(e,t)=>{var i=e[t];if("function"==typeof i)return i;i&&!Array.isArray(i)&&(e[t]=[i])},m=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)},y=(e,t)=>"number"==typeof e&&"number"==typeof t?e>t?1:e<t?-1:0:(e=a(e+"").toLowerCase())>(t=a(t+"").toLowerCase())?1:t>e?-1:0;class b{constructor(e,t){this.items=void 0,this.settings=void 0,this.items=e,this.settings=t||{diacritics:!0}}tokenize(e,t,i){if(!e||!e.length)return[];const n=[],s=e.split(/\s+/);var o;return i&&(o=new RegExp("^("+Object.keys(i).map(g).join("|")+"):(.*)$")),s.forEach(e=>{let i,s=null,r=null;o&&(i=e.match(o))&&(s=i[1],e=i[2]),e.length>0&&(r=g(e),this.settings.diacritics&&(r=u(r)),t&&(r="\\b"+r)),n.push({string:e,regex:r?new RegExp(r,"iu"):null,field:s})}),n}getScoreFunction(e,t){var i=this.prepareSearch(e,t);return this._getScoreFunction(i)}_getScoreFunction(e){const t=e.tokens,i=t.length;if(!i)return function(){return 0};const n=e.options.fields,s=e.weights,o=n.length,r=e.getAttrFn;if(!o)return function(){return 1};const l=1===o?function(e,t){const i=n[0].field;return f(r(t,i),e,s[i])}:function(e,t){var i=0;if(e.field){const n=r(t,e.field);!e.regex&&n?i+=1/o:i+=f(n,e,1)}else m(s,(n,s)=>{i+=f(r(t,s),e,n)});return i/o};return 1===i?function(e){return l(t[0],e)}:"and"===e.options.conjunction?function(e){for(var n,s=0,o=0;s<i;s++){if((n=l(t[s],e))<=0)return 0;o+=n}return o/i}:function(e){var n=0;return m(t,t=>{n+=l(t,e)}),n/i}}getSortFunction(e,t){var i=this.prepareSearch(e,t);return this._getSortFunction(i)}_getSortFunction(e){var t,i,n;const s=this,o=e.options,r=!e.query&&o.sort_empty?o.sort_empty:o.sort,l=[],a=[];if("function"==typeof r)return r.bind(this);const c=function(t,i){return"$score"===t?i.score:e.getAttrFn(s.items[i.id],t)};if(r)for(t=0,i=r.length;t<i;t++)(e.query||"$score"!==r[t].field)&&l.push(r[t]);if(e.query){for(n=!0,t=0,i=l.length;t<i;t++)if("$score"===l[t].field){n=!1;break}n&&l.unshift({field:"$score",direction:"desc"})}else for(t=0,i=l.length;t<i;t++)if("$score"===l[t].field){l.splice(t,1);break}for(t=0,i=l.length;t<i;t++)a.push("desc"===l[t].direction?-1:1);const d=l.length;if(d){if(1===d){const e=l[0].field,t=a[0];return function(i,n){return t*y(c(e,i),c(e,n))}}return function(e,t){var i,n,s;for(i=0;i<d;i++)if(s=l[i].field,n=a[i]*y(c(s,e),c(s,t)))return n;return 0}}return null}prepareSearch(e,t){const i={};var n=Object.assign({},t);if(v(n,"sort"),v(n,"sort_empty"),n.fields){v(n,"fields");const e=[];n.fields.forEach(t=>{"string"==typeof t&&(t={field:t,weight:1}),e.push(t),i[t.field]="weight"in t?t.weight:1}),n.fields=e}return{options:n,query:e.toLowerCase().trim(),tokens:this.tokenize(e,n.respect_word_boundaries,i),total:0,items:[],weights:i,getAttrFn:n.nesting?h:p}}search(e,t){var i,n;n=this.prepareSearch(e,t),t=n.options,e=n.query;const s=t.score||this._getScoreFunction(n);e.length?m(this.items,(e,o)=>{i=s(e),(!1===t.filter||i>0)&&n.items.push({score:i,id:o})}):m(this.items,(e,t)=>{n.items.push({score:1,id:t})});const o=this._getSortFunction(n);return o&&n.items.sort(o),n.total=n.items.length,"number"==typeof t.limit&&(n.items=n.items.slice(0,t.limit)),n}}const O=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(w(e)){let t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}return document.querySelector(e)},w=e=>"string"==typeof e&&e.indexOf("<")>-1,_=(e,t)=>{var i=document.createEvent("HTMLEvents");i.initEvent(t,!0,!1),e.dispatchEvent(i)},S=(e,t)=>{Object.assign(e.style,t)},I=(e,...t)=>{var i=C(t);(e=x(e)).map(e=>{i.map(t=>{e.classList.add(t)})})},F=(e,...t)=>{var i=C(t);(e=x(e)).map(e=>{i.map(t=>{e.classList.remove(t)})})},C=e=>{var t=[];return m(e,e=>{"string"==typeof e&&(e=e.trim().split(/[\11\12\14\15\40]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},x=e=>(Array.isArray(e)||(e=[e]),e),A=(e,t,i)=>{if(!i||i.contains(e))for(;e&&e.matches;){if(e.matches(t))return e;e=e.parentNode}},k=(e,t=0)=>t>0?e[e.length-1]:e[0],P=(e,t)=>{if(!e)return-1;t=t||e.nodeName;for(var i=0;e=e.previousElementSibling;)e.matches(t)&&i++;return i},E=(e,t)=>{m(t,(t,i)=>{null==t?e.removeAttribute(i):e.setAttribute(i,""+t)})},L=(e,t)=>{e.parentNode&&e.parentNode.replaceChild(t,e)},M=(e,t)=>{if(null===t)return;if("string"==typeof t){if(!t.length)return;t=new RegExp(t,"i")}const i=e=>3===e.nodeType?(e=>{var i=e.data.match(t);if(i&&e.data.length>0){var n=document.createElement("span");n.className="highlight";var s=e.splitText(i.index);s.splitText(i[0].length);var o=s.cloneNode(!0);return n.appendChild(o),L(s,n),1}return 0})(e):((e=>{if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&("highlight"!==e.className||"SPAN"!==e.tagName))for(var t=0;t<e.childNodes.length;++t)t+=i(e.childNodes[t])})(e),0);i(e)},T="undefined"!=typeof navigator&&/Mac/.test(navigator.userAgent)?"metaKey":"ctrlKey";var j={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(e){return e.length>0},render:{}};const R=e=>null==e?null:B(e),B=e=>"boolean"==typeof e?e?"1":"0":e+"",D=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),N=(e,t)=>{var i;return function(n,s){var o=this;i&&(o.loading=Math.max(o.loading-1,0),clearTimeout(i)),i=setTimeout((function(){i=null,o.loadedSearches[n]=!0,e.call(o,n,s)}),t)}},V=(e,t,i)=>{var n,s=e.trigger,o={};for(n of(e.trigger=function(){var i=arguments[0];if(-1===t.indexOf(i))return s.apply(e,arguments);o[i]=arguments},i.apply(e,[]),e.trigger=s,t))n in o&&s.apply(e,o[n])},q=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},z=(e,t,i,n)=>{e.addEventListener(t,i,n)},G=(e,t)=>!!t&&!!t[e]&&1==(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0),H=(e,t)=>{const i=e.getAttribute("id");return i||(e.setAttribute("id",t),t)},Q=e=>e.replace(/[\\"']/g,"\\$&"),K=(e,t)=>{t&&e.append(t)};function U(e,t){var i=Object.assign({},j,t),n=i.dataAttr,s=i.labelField,o=i.valueField,r=i.disabledField,l=i.optgroupField,a=i.optgroupLabelField,c=i.optgroupValueField,d=e.tagName.toLowerCase(),u=e.getAttribute("placeholder")||e.getAttribute("data-placeholder");if(!u&&!i.allowEmptyOption){let t=e.querySelector('option[value=""]');t&&(u=t.textContent)}var p,h,f,g,v,y,b={placeholder:u,options:[],optgroups:[],items:[],maxItems:null};return"select"===d?(h=b.options,f={},g=1,v=e=>{var t=Object.assign({},e.dataset),i=n&&t[n];return"string"==typeof i&&i.length&&(t=Object.assign(t,JSON.parse(i))),t},y=(e,t)=>{var n=R(e.value);if(null!=n&&(n||i.allowEmptyOption)){if(f.hasOwnProperty(n)){if(t){var a=f[n][l];a?Array.isArray(a)?a.push(t):f[n][l]=[a,t]:f[n][l]=t}}else{var c=v(e);c[s]=c[s]||e.textContent,c[o]=c[o]||n,c[r]=c[r]||e.disabled,c[l]=c[l]||t,c.$option=e,f[n]=c,h.push(c)}e.selected&&b.items.push(n)}},b.maxItems=e.hasAttribute("multiple")?null:1,m(e.children,e=>{var t,i,n;"optgroup"===(p=e.tagName.toLowerCase())?((n=v(t=e))[a]=n[a]||t.getAttribute("label")||"",n[c]=n[c]||g++,n[r]=n[r]||t.disabled,b.optgroups.push(n),i=n[c],m(t.children,e=>{y(e,i)})):"option"===p&&y(e)})):(()=>{const t=e.getAttribute(n);if(t)b.options=JSON.parse(t),m(b.options,e=>{b.items.push(e[o])});else{var r=e.value.trim()||"";if(!i.allowEmptyOption&&!r.length)return;const t=r.split(i.delimiter);m(t,e=>{const t={};t[s]=e,t[o]=e,b.options.push(t)}),b.items=t}})(),Object.assign({},j,b,t)}var W=0;class Z extends(function(e){return e.plugins={},class extends e{constructor(...e){super(...e),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(t,i){e.plugins[t]={name:t,fn:i}}initializePlugins(e){var t,i;const n=this,s=[];if(Array.isArray(e))e.forEach(e=>{"string"==typeof e?s.push(e):(n.plugins.settings[e.name]=e.options,s.push(e.name))});else if(e)for(t in e)e.hasOwnProperty(t)&&(n.plugins.settings[t]=e[t],s.push(t));for(;i=s.shift();)n.require(i)}loadPlugin(t){var i=this.plugins,n=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');i.requested[t]=!0,i.loaded[t]=n.fn.apply(this,[this.plugins.settings[t]||{}]),i.names.push(t)}require(e){var t=this.plugins;if(!this.plugins.loaded.hasOwnProperty(e)){if(t.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');this.loadPlugin(e)}return t.loaded[e]}}}(t)){constructor(e,t){var i;super(),this.control_input=void 0,this.wrapper=void 0,this.dropdown=void 0,this.control=void 0,this.dropdown_content=void 0,this.focus_node=void 0,this.order=0,this.settings=void 0,this.input=void 0,this.tabIndex=void 0,this.is_select_tag=void 0,this.rtl=void 0,this.inputId=void 0,this._destroy=void 0,this.sifter=void 0,this.isOpen=!1,this.isDisabled=!1,this.isRequired=void 0,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.hasOptions=!1,this.currentResults=void 0,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],W++;var n=O(e);if(n.tomselect)throw new Error("Tom Select already initialized on this element");n.tomselect=this,i=(window.getComputedStyle&&window.getComputedStyle(n,null)).getPropertyValue("direction");const s=U(n,t);this.settings=s,this.input=n,this.tabIndex=n.tabIndex||0,this.is_select_tag="select"===n.tagName.toLowerCase(),this.rtl=/rtl/i.test(i),this.inputId=H(n,"tomselect-"+W),this.isRequired=n.required,this.sifter=new b(this.options,{diacritics:s.diacritics}),s.mode=s.mode||(1===s.maxItems?"single":"multi"),"boolean"!=typeof s.hideSelected&&(s.hideSelected="multi"===s.mode),"boolean"!=typeof s.hidePlaceholder&&(s.hidePlaceholder="multi"!==s.mode);var o=s.createFilter;"function"!=typeof o&&("string"==typeof o&&(o=new RegExp(o)),o instanceof RegExp?s.createFilter=e=>o.test(e):s.createFilter=e=>this.settings.duplicates||!this.options[e]),this.initializePlugins(s.plugins),this.setupCallbacks(),this.setupTemplates();const r=O("<div>"),l=O("<div>"),a=this._render("dropdown"),c=O('<div role="listbox" tabindex="-1">'),d=this.input.getAttribute("class")||"",u=s.mode;var p;I(r,s.wrapperClass,d,u),I(l,s.controlClass),K(r,l),I(a,s.dropdownClass,u),s.copyClassesToDropdown&&I(a,d),I(c,s.dropdownContentClass),K(a,c),O(s.dropdownParent||r).appendChild(a),w(s.controlInput)?(p=O(s.controlInput),m(["autocorrect","autocapitalize","autocomplete"],e=>{n.getAttribute(e)&&E(p,{[e]:n.getAttribute(e)})}),p.tabIndex=-1,l.appendChild(p),this.focus_node=p):s.controlInput?(p=O(s.controlInput),this.focus_node=p):(p=O("<input/>"),this.focus_node=l),this.wrapper=r,this.dropdown=a,this.dropdown_content=c,this.control=l,this.control_input=p,this.setup()}setup(){const e=this,t=e.settings,i=e.control_input,n=e.dropdown,s=e.dropdown_content,o=e.wrapper,r=e.control,l=e.input,a=e.focus_node,c={passive:!0},d=e.inputId+"-ts-dropdown";E(s,{id:d}),E(a,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":d});const u=H(a,e.inputId+"-ts-control"),p="label[for='"+(e=>e.replace(/['"\\]/g,"\\$&"))(e.inputId)+"']",h=document.querySelector(p),f=e.focus.bind(e);if(h){z(h,"click",f),E(h,{for:u});const t=H(h,e.inputId+"-ts-label");E(a,{"aria-labelledby":t}),E(s,{"aria-labelledby":t})}if(o.style.width=l.style.width,e.plugins.names.length){const t="plugin-"+e.plugins.names.join(" plugin-");I([o,n],t)}(null===t.maxItems||t.maxItems>1)&&e.is_select_tag&&E(l,{multiple:"multiple"}),t.placeholder&&E(i,{placeholder:t.placeholder}),!t.splitOn&&t.delimiter&&(t.splitOn=new RegExp("\\s*"+g(t.delimiter)+"+\\s*")),t.load&&t.loadThrottle&&(t.load=N(t.load,t.loadThrottle)),e.control_input.type=l.type,z(n,"click",t=>{const i=A(t.target,"[data-selectable]");i&&(e.onOptionSelect(t,i),q(t,!0))}),z(r,"click",t=>{var n=A(t.target,"[data-ts-item]",r);n&&e.onItemSelect(t,n)?q(t,!0):""==i.value&&(e.onClick(),q(t,!0))}),z(a,"keydown",t=>e.onKeyDown(t)),z(i,"keypress",t=>e.onKeyPress(t)),z(i,"input",t=>e.onInput(t)),z(a,"resize",()=>e.positionDropdown(),c),z(a,"blur",t=>e.onBlur(t)),z(a,"focus",t=>e.onFocus(t)),z(a,"paste",t=>e.onPaste(t));const v=t=>{const s=t.composedPath()[0];if(!o.contains(s)&&!n.contains(s))return e.isFocused&&e.blur(),void e.inputState();s==i&&e.isOpen?t.stopPropagation():q(t,!0)};var m=()=>{e.isOpen&&e.positionDropdown()};z(document,"mousedown",v),z(window,"scroll",m,c),z(window,"resize",m,c),this._destroy=()=>{document.removeEventListener("mousedown",v),window.removeEventListener("scroll",m),window.removeEventListener("resize",m),h&&h.removeEventListener("click",f)},this.revertSettings={innerHTML:l.innerHTML,tabIndex:l.tabIndex},l.tabIndex=-1,l.insertAdjacentElement("afterend",e.wrapper),e.sync(!1),t.items=[],delete t.optgroups,delete t.options,z(l,"invalid",t=>{e.isValid&&(e.isValid=!1,e.isInvalid=!0,e.refreshState())}),e.updateOriginalInput(),e.refreshItems(),e.close(!1),e.inputState(),e.isSetup=!0,l.disabled?e.disable():e.enable(),e.on("change",this.onChange),I(l,"tomselected","ts-hidden-accessible"),e.trigger("initialize"),!0===t.preload&&e.preload()}setupOptions(e=[],t=[]){this.addOptions(e),m(t,e=>{this.registerOptionGroup(e)})}setupTemplates(){var e=this.settings.labelField,t=this.settings.optgroupLabelField,i={optgroup:e=>{let t=document.createElement("div");return t.className="optgroup",t.appendChild(e.options),t},optgroup_header:(e,i)=>'<div class="optgroup-header">'+i(e[t])+"</div>",option:(t,i)=>"<div>"+i(t[e])+"</div>",item:(t,i)=>"<div>"+i(t[e])+"</div>",option_create:(e,t)=>'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};this.settings.render=Object.assign({},i,this.settings.render)}setupCallbacks(){var e,t,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in i)(t=this.settings[i[e]])&&this.on(e,t)}sync(e=!0){const t=e?U(this.input,{delimiter:this.settings.delimiter}):this.settings;this.setupOptions(t.options,t.optgroups),this.setValue(t.items||[],!0),this.lastQuery=null}onClick(){if(this.activeItems.length>0)return this.clearActiveItems(),void this.focus();this.isFocused&&this.isOpen?this.blur():this.focus()}onMouseDown(){}onChange(){_(this.input,"input"),_(this.input,"change")}onPaste(e){var t=this;t.isInputHidden||t.isLocked?q(e):t.settings.splitOn&&setTimeout(()=>{var e=t.inputValue();if(e.match(t.settings.splitOn)){var i=e.trim().split(t.settings.splitOn);m(i,e=>{t.createItem(e)})}},0)}onKeyPress(e){if(!this.isLocked){var t=String.fromCharCode(e.keyCode||e.which);return this.settings.create&&"multi"===this.settings.mode&&t===this.settings.delimiter?(this.createItem(),void q(e)):void 0}q(e)}onKeyDown(e){if(this.isLocked)9!==e.keyCode&&q(e);else{switch(e.keyCode){case 65:if(G(T,e)&&""==this.control_input.value)return q(e),void this.selectAll();break;case 27:return this.isOpen&&(q(e,!0),this.close()),void this.clearActiveItems();case 40:if(!this.isOpen&&this.hasOptions)this.open();else if(this.activeOption){let e=this.getAdjacent(this.activeOption,1);e&&this.setActiveOption(e)}return void q(e);case 38:if(this.activeOption){let e=this.getAdjacent(this.activeOption,-1);e&&this.setActiveOption(e)}return void q(e);case 13:return void(this.canSelect(this.activeOption)?(this.onOptionSelect(e,this.activeOption),q(e)):this.settings.create&&this.createItem()&&q(e));case 37:return void this.advanceSelection(-1,e);case 39:return void this.advanceSelection(1,e);case 9:return void(this.settings.selectOnTab&&(this.canSelect(this.activeOption)&&(this.onOptionSelect(e,this.activeOption),q(e)),this.settings.create&&this.createItem()&&q(e)));case 8:case 46:return void this.deleteSelection(e)}this.isInputHidden&&!G(T,e)&&q(e)}}onInput(e){if(!this.isLocked){var t=this.inputValue();this.lastValue!==t&&(this.lastValue=t,this.settings.shouldLoad.call(this,t)&&this.load(t),this.refreshOptions(),this.trigger("type",t))}}onFocus(e){var t=this.isFocused;if(this.isDisabled)return this.blur(),void q(e);this.ignoreFocus||(this.isFocused=!0,"focus"===this.settings.preload&&this.preload(),t||this.trigger("focus"),this.activeItems.length||(this.showInput(),this.refreshOptions(!!this.settings.openOnFocus)),this.refreshState())}onBlur(e){if(!1!==document.hasFocus()){var t=this;if(t.isFocused){t.isFocused=!1,t.ignoreFocus=!1;var i=()=>{t.close(),t.setActiveItem(),t.setCaret(t.items.length),t.trigger("blur")};t.settings.create&&t.settings.createOnBlur?t.createItem(null,!1,i):i()}}}onOptionSelect(e,t){var i,n=this;t.parentElement&&t.parentElement.matches("[data-disabled]")||(t.classList.contains("create")?n.createItem(null,!0,()=>{n.settings.closeAfterSelect&&n.close()}):void 0!==(i=t.dataset.value)&&(n.lastQuery=null,n.addItem(i),n.settings.closeAfterSelect&&n.close(),!n.settings.hideSelected&&e.type&&/click/.test(e.type)&&n.setActiveOption(t)))}canSelect(e){return!!(this.isOpen&&e&&this.dropdown_content.contains(e))}onItemSelect(e,t){return!this.isLocked&&"multi"===this.settings.mode&&(q(e),this.setActiveItem(t,e),!0)}canLoad(e){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(e)}load(e){if(!this.canLoad(e))return;I(this.wrapper,this.settings.loadingClass),this.loading++;const t=this.loadCallback.bind(this);this.settings.load.call(this,e,t)}loadCallback(e,t){const i=this;i.loading=Math.max(i.loading-1,0),i.lastQuery=null,i.clearActiveOption(),i.setupOptions(e,t),i.refreshOptions(i.isFocused&&!i.isInputHidden),i.loading||F(i.wrapper,i.settings.loadingClass),i.trigger("load",e,t)}preload(){var e=this.wrapper.classList;e.contains("preloaded")||(e.add("preloaded"),this.load(""))}setTextboxValue(e=""){var t=this.control_input;t.value!==e&&(t.value=e,_(t,"update"),this.lastValue=e)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){V(this,t?[]:["change"],()=>{this.clear(t),this.addItems(e,t)})}setMaxItems(e){0===e&&(e=null),this.settings.maxItems=e,this.refreshState()}setActiveItem(e,t){var i,n,s,o,r,l;if("single"!==this.settings.mode){if(!e)return this.clearActiveItems(),void(this.isFocused&&this.showInput());if("click"===(i=t&&t.type.toLowerCase())&&G("shiftKey",t)&&this.activeItems.length){for(l=this.getLastActive(),(s=Array.prototype.indexOf.call(this.control.children,l))>(o=Array.prototype.indexOf.call(this.control.children,e))&&(r=s,s=o,o=r),n=s;n<=o;n++)e=this.control.children[n],-1===this.activeItems.indexOf(e)&&this.setActiveItemClass(e);q(t)}else"click"===i&&G(T,t)||"keydown"===i&&G("shiftKey",t)?e.classList.contains("active")?this.removeActiveItem(e):this.setActiveItemClass(e):(this.clearActiveItems(),this.setActiveItemClass(e));this.hideInput(),this.isFocused||this.focus()}}setActiveItemClass(e){const t=this,i=t.control.querySelector(".last-active");i&&F(i,"last-active"),I(e,"active last-active"),t.trigger("item_select",e),-1==t.activeItems.indexOf(e)&&t.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1),F(e,"active")}clearActiveItems(){F(this.activeItems,"active"),this.activeItems=[]}setActiveOption(e){e!==this.activeOption&&(this.clearActiveOption(),e&&(this.activeOption=e,E(this.focus_node,{"aria-activedescendant":e.getAttribute("id")}),E(e,{"aria-selected":"true"}),I(e,"active"),this.scrollToOption(e)))}scrollToOption(e,t){if(!e)return;const i=this.dropdown_content,n=i.clientHeight,s=i.scrollTop||0,o=e.offsetHeight,r=e.getBoundingClientRect().top-i.getBoundingClientRect().top+s;r+o>n+s?this.scroll(r-n+o,t):r<s&&this.scroll(r,t)}scroll(e,t){const i=this.dropdown_content;t&&(i.style.scrollBehavior=t),i.scrollTop=e,i.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(F(this.activeOption,"active"),E(this.activeOption,{"aria-selected":null})),this.activeOption=null,E(this.focus_node,{"aria-activedescendant":null})}selectAll(){const e=this;if("single"===e.settings.mode)return;const t=e.controlChildren();t.length&&(e.hideInput(),e.close(),e.activeItems=t,m(t,t=>{e.setActiveItemClass(t)}))}inputState(){this.control.contains(this.control_input)&&(E(this.control_input,{placeholder:this.settings.placeholder}),this.activeItems.length>0||!this.isFocused&&this.settings.hidePlaceholder&&this.items.length>0?(this.setTextboxValue(),this.isInputHidden=!0):(this.settings.hidePlaceholder&&this.items.length>0&&E(this.control_input,{placeholder:""}),this.isInputHidden=!1),this.wrapper.classList.toggle("input-hidden",this.isInputHidden))}hideInput(){this.inputState()}showInput(){this.inputState()}inputValue(){return this.control_input.value.trim()}focus(){var e=this;e.isDisabled||(e.ignoreFocus=!0,e.control_input.offsetWidth?e.control_input.focus():e.focus_node.focus(),setTimeout(()=>{e.ignoreFocus=!1,e.onFocus()},0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings,t=e.sortField;return"string"==typeof e.sortField&&(t=[{field:e.sortField}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,i,n,s=this.getSearchOptions();if(this.settings.score&&"function"!=typeof(n=this.settings.score.call(this,e)))throw new Error('Tom Select "score" setting must be a function that returns a function');if(e!==this.lastQuery?(this.lastQuery=e,i=this.sifter.search(e,Object.assign(s,{score:n})),this.currentResults=i):i=Object.assign({},this.currentResults),this.settings.hideSelected)for(t=i.items.length-1;t>=0;t--){let e=R(i.items[t].id);e&&-1!==this.items.indexOf(e)&&i.items.splice(t,1)}return i}refreshOptions(e=!0){var t,i,n,s,o,r,l,a,c,d,u;const p={},h=[];var f,g=this,v=g.inputValue(),y=g.search(v),b=null,O=g.settings.shouldOpen||!1,w=g.dropdown_content;for(g.activeOption&&(c=g.activeOption.dataset.value,d=g.activeOption.closest("[data-group]")),s=y.items.length,"number"==typeof g.settings.maxOptions&&(s=Math.min(s,g.settings.maxOptions)),s>0&&(O=!0),t=0;t<s;t++){let e=y.items[t].id,s=g.options[e],l=g.getOption(e,!0);for(g.settings.hideSelected||l.classList.toggle("selected",g.items.includes(e)),o=s[g.settings.optgroupField]||"",i=0,n=(r=Array.isArray(o)?o:[o])&&r.length;i<n;i++)o=r[i],g.optgroups.hasOwnProperty(o)||(o=""),p.hasOwnProperty(o)||(p[o]=document.createDocumentFragment(),h.push(o)),i>0&&(l=l.cloneNode(!0),E(l,{id:s.$id+"-clone-"+i,"aria-selected":null}),l.classList.add("ts-cloned"),F(l,"active")),b||c!=e||(d?d.dataset.group===o&&(b=l):b=l),p[o].appendChild(l)}this.settings.lockOptgroupOrder&&h.sort((e,t)=>(g.optgroups[e]&&g.optgroups[e].$order||0)-(g.optgroups[t]&&g.optgroups[t].$order||0)),l=document.createDocumentFragment(),m(h,e=>{if(g.optgroups.hasOwnProperty(e)&&p[e].children.length){let t=document.createDocumentFragment(),i=g.render("optgroup_header",g.optgroups[e]);K(t,i),K(t,p[e]);let n=g.render("optgroup",{group:g.optgroups[e],options:t});K(l,n)}else K(l,p[e])}),w.innerHTML="",K(w,l),g.settings.highlight&&(f=w.querySelectorAll("span.highlight"),Array.prototype.forEach.call(f,(function(e){var t=e.parentNode;t.replaceChild(e.firstChild,e),t.normalize()})),y.query.length&&y.tokens.length&&m(y.tokens,e=>{M(w,e.regex)}));var _=e=>{let t=g.render(e,{input:v});return t&&(O=!0,w.insertBefore(t,w.firstChild)),t};if(g.loading?_("loading"):g.settings.shouldLoad.call(g,v)?0===y.items.length&&_("no_results"):_("not_loading"),(a=g.canCreate(v))&&(u=_("option_create")),g.hasOptions=y.items.length>0||a,O){if(y.items.length>0){if(!b&&"single"===g.settings.mode&&g.items.length&&(b=g.getOption(g.items[0])),!w.contains(b)){let e=0;u&&!g.settings.addPrecedence&&(e=1),b=g.selectable()[e]}}else u&&(b=u);e&&!g.isOpen&&(g.open(),g.scrollToOption(b,"auto")),g.setActiveOption(b)}else g.clearActiveOption(),e&&g.isOpen&&g.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e,t=!1){const i=this;if(Array.isArray(e))return i.addOptions(e,t),!1;const n=R(e[i.settings.valueField]);return null!==n&&!i.options.hasOwnProperty(n)&&(e.$order=e.$order||++i.order,e.$id=i.inputId+"-opt-"+e.$order,i.options[n]=e,i.lastQuery=null,t&&(i.userOptions[n]=t,i.trigger("option_add",n,e)),n)}addOptions(e,t=!1){m(e,e=>{this.addOption(e,t)})}registerOption(e){return this.addOption(e)}registerOptionGroup(e){var t=R(e[this.settings.optgroupValueField]);return null!==t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)}addOptionGroup(e,t){var i;t[this.settings.optgroupValueField]=e,(i=this.registerOptionGroup(t))&&this.trigger("optgroup_add",i,t)}removeOptionGroup(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(e,t){const i=this;var n,s;const o=R(e),r=R(t[i.settings.valueField]);if(null===o)return;if(!i.options.hasOwnProperty(o))return;if("string"!=typeof r)throw new Error("Value must be set in option data");const l=i.getOption(o),a=i.getItem(o);if(t.$order=t.$order||i.options[o].$order,delete i.options[o],i.uncacheValue(r),i.options[r]=t,l){if(i.dropdown_content.contains(l)){const e=i._render("option",t);L(l,e),i.activeOption===l&&i.setActiveOption(e)}l.remove()}a&&(-1!==(s=i.items.indexOf(o))&&i.items.splice(s,1,r),n=i._render("item",t),a.classList.contains("active")&&I(n,"active"),L(a,n)),i.lastQuery=null}removeOption(e,t){e=B(e),this.uncacheValue(e),delete this.userOptions[e],delete this.options[e],this.lastQuery=null,this.trigger("option_remove",e),this.removeItem(e,t)}clearOptions(){this.loadedSearches={},this.userOptions={},this.clearCache();var e={};m(this.options,(t,i)=>{this.items.indexOf(i)>=0&&(e[i]=this.options[i])}),this.options=this.sifter.items=e,this.lastQuery=null,this.trigger("option_clear")}getOption(e,t=!1){const i=R(e);if(null!==i&&this.options.hasOwnProperty(i)){const e=this.options[i];if(e.$div)return e.$div;if(t)return this._render("option",e)}return null}getAdjacent(e,t,i="option"){var n;if(!e)return null;n="item"==i?this.controlChildren():this.dropdown_content.querySelectorAll("[data-selectable]");for(let i=0;i<n.length;i++)if(n[i]==e)return t>0?n[i+1]:n[i-1];return null}getItem(e){if("object"==typeof e)return e;var t=R(e);return null!==t?this.control.querySelector(`[data-value="${Q(t)}"]`):null}addItems(e,t){var i=this,n=Array.isArray(e)?e:[e];for(let e=0,s=(n=n.filter(e=>-1===i.items.indexOf(e))).length;e<s;e++)i.isPending=e<s-1,i.addItem(n[e],t)}addItem(e,t){V(this,t?[]:["change","dropdown_close"],()=>{var i,n;const s=this,o=s.settings.mode,r=R(e);if((!r||-1===s.items.indexOf(r)||("single"===o&&s.close(),"single"!==o&&s.settings.duplicates))&&null!==r&&s.options.hasOwnProperty(r)&&("single"===o&&s.clear(t),"multi"!==o||!s.isFull())){if(i=s._render("item",s.options[r]),s.control.contains(i)&&(i=i.cloneNode(!0)),n=s.isFull(),s.items.splice(s.caretPos,0,r),s.insertAtCaret(i),s.isSetup){if(!s.isPending&&s.settings.hideSelected){let e=s.getOption(r),t=s.getAdjacent(e,1);t&&s.setActiveOption(t)}s.isPending||s.settings.closeAfterSelect||s.refreshOptions(s.isFocused&&"single"!==o),0!=s.settings.closeAfterSelect&&s.isFull()?s.close():s.isPending||s.positionDropdown(),s.trigger("item_add",r,i),s.isPending||s.updateOriginalInput({silent:t})}(!s.isPending||!n&&s.isFull())&&(s.inputState(),s.refreshState())}})}removeItem(e=null,t){const i=this;if(!(e=i.getItem(e)))return;var n,s;const o=e.dataset.value;n=P(e),e.remove(),e.classList.contains("active")&&(s=i.activeItems.indexOf(e),i.activeItems.splice(s,1),F(e,"active")),i.items.splice(n,1),i.lastQuery=null,!i.settings.persist&&i.userOptions.hasOwnProperty(o)&&i.removeOption(o,t),n<i.caretPos&&i.setCaret(i.caretPos-1),i.updateOriginalInput({silent:t}),i.refreshState(),i.positionDropdown(),i.trigger("item_remove",o,e)}createItem(e=null,t=!0,i=(()=>{})){var n,s=this,o=s.caretPos;if(e=e||s.inputValue(),!s.canCreate(e))return i(),!1;s.lock();var r=!1,l=e=>{if(s.unlock(),!e||"object"!=typeof e)return i();var t=R(e[s.settings.valueField]);if("string"!=typeof t)return i();s.setTextboxValue(),s.addOption(e,!0),s.setCaret(o),s.addItem(t),i(e),r=!0};return n="function"==typeof s.settings.create?s.settings.create.call(this,e,l):{[s.settings.labelField]:e,[s.settings.valueField]:e},r||l(n),!0}refreshItems(){this.lastQuery=null,this.isSetup&&this.addItems(this.items),this.updateOriginalInput(),this.refreshState()}refreshState(){this.refreshValidityState();const e=this.isFull(),t=this.isLocked;this.wrapper.classList.toggle("rtl",this.rtl);const i=this.wrapper.classList;var n;i.toggle("focus",this.isFocused),i.toggle("disabled",this.isDisabled),i.toggle("required",this.isRequired),i.toggle("invalid",!this.isValid),i.toggle("locked",t),i.toggle("full",e),i.toggle("input-active",this.isFocused&&!this.isInputHidden),i.toggle("dropdown-active",this.isOpen),i.toggle("has-options",(n=this.options,0===Object.keys(n).length)),i.toggle("has-items",this.items.length>0)}refreshValidityState(){this.input.checkValidity&&(this.isValid=this.input.checkValidity(),this.isInvalid=!this.isValid)}isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const t=this;var i,n;const s=t.input.querySelector('option[value=""]');if(t.is_select_tag){const e=[],r=t.input.querySelectorAll("option:checked").length;function o(i,n,o){return i||(i=O('<option value="'+D(n)+'">'+D(o)+"</option>")),i!=s&&t.input.append(i),e.push(i),(i!=s||r>0)&&(i.selected=!0),i}t.input.querySelectorAll("option:checked").forEach(e=>{e.selected=!1}),0==t.items.length&&"single"==t.settings.mode?o(s,"",""):t.items.forEach(s=>{i=t.options[s],n=i[t.settings.labelField]||"",e.includes(i.$option)?o(t.input.querySelector(`option[value="${Q(s)}"]:not(:checked)`),s,n):i.$option=o(i.$option,s,n)})}else t.input.value=t.getValue();t.isSetup&&(e.silent||t.trigger("change",t.getValue()))}open(){this.isLocked||this.isOpen||"multi"===this.settings.mode&&this.isFull()||(this.isOpen=!0,E(this.focus_node,{"aria-expanded":"true"}),this.refreshState(),S(this.dropdown,{visibility:"hidden",display:"block"}),this.positionDropdown(),S(this.dropdown,{visibility:"visible",display:"block"}),this.focus(),this.trigger("dropdown_open",this.dropdown))}close(e=!0){var t=this.isOpen;e&&(this.setTextboxValue(),"single"===this.settings.mode&&this.items.length&&this.hideInput()),this.isOpen=!1,E(this.focus_node,{"aria-expanded":"false"}),S(this.dropdown,{display:"none"}),this.settings.hideSelected&&this.clearActiveOption(),this.refreshState(),t&&this.trigger("dropdown_close",this.dropdown)}positionDropdown(){if("body"===this.settings.dropdownParent){var e=this.control,t=e.getBoundingClientRect(),i=e.offsetHeight+t.top+window.scrollY,n=t.left+window.scrollX;S(this.dropdown,{width:t.width+"px",top:i+"px",left:n+"px"})}}clear(e){var t=this;if(t.items.length){var i=t.controlChildren();m(i,e=>{t.removeItem(e,!0)}),t.showInput(),e||t.updateOriginalInput(),t.trigger("clear")}}insertAtCaret(e){const t=this.caretPos,i=this.control;i.insertBefore(e,i.children[t]),this.setCaret(t+1)}deleteSelection(e){var t,i,n,s,o;t=e&&8===e.keyCode?-1:1,i={start:(o=this.control_input).selectionStart||0,length:(o.selectionEnd||0)-(o.selectionStart||0)};const r=[];if(this.activeItems.length)s=k(this.activeItems,t),n=P(s),t>0&&n++,m(this.activeItems,e=>r.push(e));else if((this.isFocused||"single"===this.settings.mode)&&this.items.length){const e=this.controlChildren();t<0&&0===i.start&&0===i.length?r.push(e[this.caretPos-1]):t>0&&i.start===this.inputValue().length&&r.push(e[this.caretPos])}const l=r.map(e=>e.dataset.value);if(!l.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete.call(this,l,e))return!1;for(q(e,!0),void 0!==n&&this.setCaret(n);r.length;)this.removeItem(r.pop());return this.showInput(),this.positionDropdown(),this.refreshOptions(!1),!0}advanceSelection(e,t){var i,n;this.rtl&&(e*=-1),this.inputValue().length||(G(T,t)||G("shiftKey",t)?(n=(i=this.getLastActive(e))?i.classList.contains("active")?this.getAdjacent(i,e,"item"):i:e>0?this.control_input.nextElementSibling:this.control_input.previousElementSibling)&&(n.classList.contains("active")&&this.removeActiveItem(i),this.setActiveItemClass(n)):this.moveCaret(e))}moveCaret(e){}getLastActive(e){let t=this.control.querySelector(".last-active");if(t)return t;var i=this.control.querySelectorAll(".active");return i?k(i,e):void 0}setCaret(e){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.isLocked=!0,this.refreshState()}unlock(){this.isLocked=!1,this.refreshState()}disable(){this.input.disabled=!0,this.control_input.disabled=!0,this.focus_node.tabIndex=-1,this.isDisabled=!0,this.close(),this.lock()}enable(){this.input.disabled=!1,this.control_input.disabled=!1,this.focus_node.tabIndex=this.tabIndex,this.isDisabled=!1,this.unlock()}destroy(){var e=this.revertSettings;this.trigger("destroy"),this.off(),this.wrapper.remove(),this.dropdown.remove(),this.input.innerHTML=e.innerHTML,this.input.tabIndex=e.tabIndex,F(this.input,"tomselected","ts-hidden-accessible"),this._destroy(),delete this.input.tomselect}render(e,t){return"function"!=typeof this.settings.render[e]?null:this._render(e,t)}_render(e,t){var i,n,s="";const o=this;return"option"!==e&&"item"!=e||(s=B(t[o.settings.valueField])),null==(n=o.settings.render[e].call(this,t,D))||(n=O(n),"option"===e||"option_create"===e?t[o.settings.disabledField]?E(n,{"aria-disabled":"true"}):E(n,{"data-selectable":""}):"optgroup"===e&&(i=t.group[o.settings.optgroupValueField],E(n,{"data-group":i}),t.group[o.settings.disabledField]&&E(n,{"data-disabled":""})),"option"!==e&&"item"!==e||(E(n,{"data-value":s}),"item"===e?(I(n,o.settings.itemClass),E(n,{"data-ts-item":""})):(I(n,o.settings.optionClass),E(n,{role:"option",id:t.$id}),o.options[s].$div=n))),n}clearCache(){m(this.options,(e,t)=>{e.$div&&(e.$div.remove(),delete e.$div)})}uncacheValue(e){const t=this.getOption(e);t&&t.remove()}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,t,i){var n=this,s=n[t];n[t]=function(){var t,o;return"after"===e&&(t=s.apply(n,arguments)),o=i.apply(n,arguments),"instead"===e?o:("before"===e&&(t=s.apply(n,arguments)),t)}}}return Z.define("change_listener",(function(){z(this.input,"change",()=>{this.sync()})})),Z.define("checkbox_options",(function(){var e=this,t=e.onOptionSelect;e.settings.hideSelected=!1;var i=function(e){setTimeout(()=>{var t=e.querySelector("input");e.classList.contains("selected")?t.checked=!0:t.checked=!1},1)};e.hook("after","setupTemplates",()=>{var t=e.settings.render.option;e.settings.render.option=(i,n)=>{var s=O(t.call(e,i,n)),o=document.createElement("input");o.addEventListener("click",(function(e){q(e)})),o.type="checkbox";const r=R(i[e.settings.valueField]);return r&&e.items.indexOf(r)>-1&&(o.checked=!0),s.prepend(o),s}}),e.on("item_remove",t=>{var n=e.getOption(t);n&&(n.classList.remove("selected"),i(n))}),e.on("item_add",t=>{var n=e.getOption(t);n&&i(n)}),e.hook("instead","onOptionSelect",(n,s)=>{if(s.classList.contains("selected"))return s.classList.remove("selected"),e.removeItem(s.dataset.value),e.refreshOptions(),void q(n,!0);t.call(e,n,s),i(s)})})),Z.define("clear_button",(function(e){const t=this,i=Object.assign({className:"clear-button",title:"Clear All",html:e=>`<div class="${e.className}" title="${e.title}">&times;</div>`},e);t.on("initialize",()=>{var e=O(i.html(i));e.addEventListener("click",e=>{t.isDisabled||(t.clear(),"single"===t.settings.mode&&t.settings.allowEmptyOption&&t.addItem(""),e.preventDefault(),e.stopPropagation())}),t.control.appendChild(e)})})),Z.define("drag_drop",(function(){var e=this;if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===e.settings.mode){var t=e.lock,i=e.unlock;e.hook("instead","lock",()=>{var i=$(e.control).data("sortable");return i&&i.disable(),t.call(e)}),e.hook("instead","unlock",()=>{var t=$(e.control).data("sortable");return t&&t.enable(),i.call(e)}),e.on("initialize",()=>{var t=$(e.control).sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:e.isLocked,start:(e,i)=>{i.placeholder.css("width",i.helper.css("width")),t.css({overflow:"visible"})},stop:()=>{t.css({overflow:"hidden"});var i=[];t.children("[data-value]").each((function(){this.dataset.value&&i.push(this.dataset.value)})),e.setValue(i)}})})}})),Z.define("dropdown_header",(function(e){const t=this,i=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:e=>'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a class="'+e.closeClass+'">&times;</a></div></div>'},e);t.on("initialize",()=>{var e=O(i.html(i)),n=e.querySelector("."+i.closeClass);n&&n.addEventListener("click",e=>{q(e,!0),t.close()}),t.dropdown.insertBefore(e,t.dropdown.firstChild)})})),Z.define("caret_position",(function(){var e=this;e.hook("instead","setCaret",t=>{"single"!==e.settings.mode&&e.control.contains(e.control_input)?(t=Math.max(0,Math.min(e.items.length,t)))==e.caretPos||e.isPending||e.controlChildren().forEach((i,n)=>{n<t?e.control_input.insertAdjacentElement("beforebegin",i):e.control.appendChild(i)}):t=e.items.length,e.caretPos=t}),e.hook("instead","moveCaret",t=>{if(!e.isFocused)return;const i=e.getLastActive(t);if(i){const n=P(i);e.setCaret(t>0?n+1:n),e.setActiveItem(),F(i,"last-active")}else e.setCaret(e.caretPos+t)})})),Z.define("dropdown_input",(function(){const e=this;e.settings.shouldOpen=!0,e.hook("before","setup",()=>{e.focus_node=e.control,I(e.control_input,"dropdown-input");const t=O('<div class="dropdown-input-wrap">');t.append(e.control_input),e.dropdown.insertBefore(t,e.dropdown.firstChild);const i=O('<input class="items-placeholder" tabindex="-1" />');i.placeholder=e.settings.placeholder||"",e.control.append(i)}),e.on("initialize",()=>{e.control_input.addEventListener("keydown",t=>{switch(t.keyCode){case 27:return e.isOpen&&(q(t,!0),e.close()),void e.clearActiveItems();case 9:e.focus_node.tabIndex=-1}return e.onKeyDown.call(e,t)}),e.on("blur",()=>{e.focus_node.tabIndex=e.isDisabled?-1:e.tabIndex}),e.on("dropdown_open",()=>{e.control_input.focus()});const t=e.onBlur;e.hook("instead","onBlur",i=>{if(!i||i.relatedTarget!=e.control_input)return t.call(e)}),z(e.control_input,"blur",()=>e.onBlur()),e.hook("before","close",()=>{e.isOpen&&e.focus_node.focus()})})})),Z.define("input_autogrow",(function(){var e=this;e.on("initialize",()=>{var t=document.createElement("span"),i=e.control_input;t.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",e.wrapper.appendChild(t);for(const e of["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"])t.style[e]=i.style[e];var n=()=>{e.items.length>0?(t.textContent=i.value,i.style.width=t.clientWidth+"px"):i.style.width=""};n(),e.on("update item_add item_remove",n),z(i,"input",n),z(i,"keyup",n),z(i,"blur",n),z(i,"update",n)})})),Z.define("no_backspace_delete",(function(){var e=this,t=e.deleteSelection;this.hook("instead","deleteSelection",i=>!!e.activeItems.length&&t.call(e,i))})),Z.define("no_active_items",(function(){this.hook("instead","setActiveItem",()=>{}),this.hook("instead","selectAll",()=>{})})),Z.define("optgroup_columns",(function(){var e=this,t=e.onKeyDown;e.hook("instead","onKeyDown",i=>{var n,s,o,r;if(!e.isOpen||37!==i.keyCode&&39!==i.keyCode)return t.call(e,i);r=A(e.activeOption,"[data-group]"),n=P(e.activeOption,"[data-selectable]"),r&&(r=37===i.keyCode?r.previousSibling:r.nextSibling)&&(s=(o=r.querySelectorAll("[data-selectable]"))[Math.min(o.length-1,n)])&&e.setActiveOption(s)})})),Z.define("remove_button",(function(e){const t=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},e);var i=this;if(t.append){var n='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+D(t.title)+'">'+t.label+"</a>";i.hook("after","setupTemplates",()=>{var e=i.settings.render.item;i.settings.render.item=(t,s)=>{var o=O(e.call(i,t,s)),r=O(n);return o.appendChild(r),z(r,"mousedown",e=>{q(e,!0)}),z(r,"click",e=>{if(q(e,!0),!i.isLocked){var t=o.dataset.value;i.removeItem(t),i.refreshOptions(!1),i.inputState()}}),o}})}})),Z.define("restore_on_backspace",(function(e){const t=this,i=Object.assign({text:e=>e[t.settings.labelField]},e);t.on("item_remove",(function(e){if(t.isFocused&&""===t.control_input.value.trim()){var n=t.options[e];n&&t.setTextboxValue(i.text.call(t,n))}}))})),Z.define("virtual_scroll",(function(){const e=this,t=e.canLoad,i=e.clearActiveOption,n=e.loadCallback;var s,o,r={},l=!1;if(e.settings.shouldLoadMore||(e.settings.shouldLoadMore=function(){if(s.clientHeight/(s.scrollHeight-s.scrollTop)>.9)return!0;if(e.activeOption){var t=e.selectable();if([...t].indexOf(e.activeOption)>=t.length-2)return!0}return!1}),!e.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";function a(t){return!("number"==typeof e.settings.maxOptions&&s.children.length>=e.settings.maxOptions||!(t in r)||!r[t])}e.settings.sortField=[{field:"$order"},{field:"$score"}],e.setNextUrl=function(e,t){r[e]=t},e.getUrl=function(t){if(t in r){const e=r[t];return r[t]=!1,e}return r={},e.settings.firstUrl.call(e,t)},e.hook("instead","clearActiveOption",()=>{if(!l)return i.call(e)}),e.hook("instead","canLoad",i=>i in r?a(i):t.call(e,i)),e.hook("instead","loadCallback",(t,i)=>{l?o&&t.length>0&&(o.dataset.value=t[0][e.settings.valueField]):e.clearOptions(),n.call(e,t,i),l=!1}),e.hook("after","refreshOptions",()=>{const t=e.lastValue;var i;a(t)?(i=e.render("loading_more",{query:t}))&&(i.setAttribute("data-selectable",""),o=i):t in r&&!s.querySelector(".no-results")&&(i=e.render("no_more_results",{query:t})),i&&(I(i,e.settings.optionClass),s.append(i))}),e.on("initialize",()=>{s=e.dropdown_content,e.settings.render=Object.assign({},{loading_more:function(){return'<div class="loading-more-results">Loading more results ... </div>'},no_more_results:function(){return'<div class="no-more-results">No more results</div>'}},e.settings.render),s.addEventListener("scroll",(function(){e.settings.shouldLoadMore.call(e)&&a(e.lastValue)&&(l||(l=!0,e.load.call(e,e.lastValue)))}))})})),Z}()},28:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Events/GetField")},29:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Events/GetModel")},3:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Fields/Core/FBFieldBase.options")},32:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Utilities/Sanitizer")},40:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Fields/Core/FBFieldWithPriceBase")},6:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Fields/Core/FBFieldWithPriceBase.Options")},66:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Fields/Options/OptionItem")},667:function(e,t,i){},9:function(e,t){e.exports=RedNaoSharedCore.default("shared/core/Store/StoreBase")},95:function(e,t){e.exports=RedNaoFormBuilder.default("FormBuilder/Utilities/Managers/CurrencyManager")}});